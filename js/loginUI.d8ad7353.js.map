{"version":3,"file":"js/loginUI.d8ad7353.js","mappings":"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","sources":["webpack://music/./src/views/login/loginUI.vue","webpack://music/./src/views/login/loginUI.vue?f5a8"],"sourcesContent":["import { withAsyncContext as _withAsyncContext } from 'vue';\nimport { unref as _unref, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, isRef as _isRef, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-696f27a3\"), n = n(), _popScopeId(), n);\n\nconst _hoisted_1 = {\n  class: \"login\"\n};\n\nconst _hoisted_2 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", null, null, -1));\n\nconst _hoisted_3 = {\n  class: \"login_layout\"\n};\n\nconst _hoisted_4 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h1\", {\n  class: \"title\"\n}, \"扫码登陆\", -1));\n\nconst _hoisted_5 = {\n  class: \"login_img\"\n};\nconst _hoisted_6 = [\"src\"];\n\nconst _hoisted_7 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"disabled_text\"\n}, \"二维码已过期\", -1));\n\nconst _hoisted_8 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", null, [/*#__PURE__*/_createElementVNode(\"span\", null, [/*#__PURE__*/_createTextVNode(\"使用 \"), /*#__PURE__*/_createElementVNode(\"a\", {\n  href: \"https://music.163.com/#/download\",\n  class: \"login_url\"\n}, \"网易云音乐App\"), /*#__PURE__*/_createTextVNode(\"扫码登陆\")])], -1));\n\nconst _hoisted_9 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"login_other\"\n}, \"选择其他登陆模式 >\", -1));\n\nimport { useStore } from \"vuex\";\nimport { getKey, getLoginImg, checkimg, loginStatus } from \"~/network\";\nexport default {\n  __name: 'loginUI',\n  props: {\n    loginShow: {\n      type: Boolean,\n      default: false\n    }\n  },\n  emits: [\"loginshow\"],\n\n  async setup(__props, {\n    emit\n  }) {\n    let __temp, __restore;\n\n    const props = __props;\n\n    const {\n      ref\n    } = require(\"@vue/reactivity\");\n\n    const {\n      watch,\n      onMounted\n    } = require(\"@vue/runtime-core\");\n\n    const store = useStore();\n    const dialogVisible = ref(false);\n    const loginImg = ref();\n    const disabledRef = ref(); // 检测二维码扫码状态\n\n    const checkimgStatus = key => {\n      return checkimg(key);\n    };\n\n    let timer; // 生成登陆二维码\n\n    const generateimg = async () => {\n      if (timer) clearInterval(timer);\n      const {\n        data\n      } = await getKey();\n      const {\n        data: {\n          qrimg\n        }\n      } = await getLoginImg(data.unikey);\n      loginImg.value = qrimg;\n      dialogVisible.value = true;\n      timer = setInterval(async () => {\n        const status = await checkimgStatus(data.unikey);\n\n        if (status.code === 800) {\n          //   alert(\"二维码已过期,请重新获取\");\n          clearInterval(timer); //显示遮罩层\n\n          disabledRef.value.style.display = \"\";\n        }\n\n        if (status.code === 801) {\n          console.log(\"等待扫码\");\n        }\n\n        if (status.code === 802) {\n          console.log(\"待确认\");\n        }\n\n        if (status.code === 803) {\n          // 这一步会返回cookie\n          clearInterval(timer); //   alert(\"授权登录成功\");\n          // 更新登陆状态\n\n          store.dispatch(\"login/chechLoginStatus\"); // store.dispatch(\"login/chechLoginStatus\", status.cookie);\n          //   将cookie存储到本地\n\n          localStorage.setItem(\"cookie\", status.cookie); //   关闭窗口\n\n          dialogVisible.value = false;\n        }\n      }, 3000);\n    }; // 发送请求\n\n\n    ;\n    [__temp, __restore] = _withAsyncContext(() => generateimg()), await __temp, __restore(); // 关闭登陆窗口\n\n    const handleClose = done => {\n      console.log(\"关闭\");\n      emit(\"loginshow\", false);\n      done();\n      clearInterval(timer);\n    }; // 刷新登陆二维码\n\n\n    const handleRefresh = () => {\n      console.log(\"刷新二维码\"); // 重新请求二维码\n\n      generateimg(); // 关闭遮罩层\n\n      disabledRef.value.style.display = \"none\";\n    };\n\n    return (_ctx, _cache) => {\n      const _component_el_button = _resolveComponent(\"el-button\");\n\n      const _component_el_dialog = _resolveComponent(\"el-dialog\");\n\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_el_dialog, {\n        modelValue: _unref(dialogVisible),\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => _isRef(dialogVisible) ? dialogVisible.value = $event : null),\n        title: \"Tips\",\n        width: \"320px\",\n        draggable: \"\",\n        \"before-close\": handleClose,\n        \"close-on-click-modal\": false\n      }, {\n        header: _withCtx(() => [_hoisted_2]),\n        default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_3, [_hoisted_4, _createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"img\", {\n          src: _unref(loginImg),\n          alt: \"\",\n          class: \"img\"\n        }, null, 8, _hoisted_6), _createElementVNode(\"div\", {\n          class: \"disabled\",\n          ref_key: \"disabledRef\",\n          ref: disabledRef,\n          style: {\n            \"display\": \"none\"\n          }\n        }, [_hoisted_7, _createVNode(_component_el_button, {\n          type: \"primary\",\n          onClick: handleRefresh\n        }, {\n          default: _withCtx(() => [_createTextVNode(\"点击刷新\")]),\n          _: 1\n        })], 512)]), _hoisted_8, _hoisted_9])]),\n        _: 1\n      }, 8, [\"modelValue\"])]);\n    };\n  }\n\n};","/* unplugin-vue-components disabled */import script from \"./loginUI.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./loginUI.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./loginUI.vue?vue&type=style&index=0&id=696f27a3&lang=less&scoped=true\"\n\nimport exportComponent from \"D:\\\\网易云\\\\music\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-696f27a3\"]])\n\nexport default __exports__"],"names":["_withScopeId","n","_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","href","_hoisted_9","__name","props","loginShow","type","Boolean","default","emits","async","__props","emit","__temp","__restore","ref","watch","onMounted","store","useStore","dialogVisible","loginImg","disabledRef","checkimgStatus","key","timer","generateimg","clearInterval","data","qrimg","unikey","value","setInterval","status","code","style","display","console","log","dispatch","localStorage","setItem","cookie","handleClose","done","handleRefresh","_ctx","_cache","_component_el_button","_component_el_dialog","modelValue","$event","title","width","draggable","header","src","alt","ref_key","onClick","_","__exports__"],"sourceRoot":""}