"use strict";(self["webpackChunkmusic"]=self["webpackChunkmusic"]||[]).push([[329],{5867:function(e,t,n){n.d(t,{t:function(){return l}});var o=n(1276),a=n(6644);function l(e){const t=a.Z.dispatch("songMenu/getSongMenuDetail",e);t.then((t=>{const n=(0,o.p)(t);a.Z.dispatch("playMusic/dispatchMusicInfo",n[0]),a.Z.dispatch("songMenu/dispatchSongsList",e)}))}},6237:function(e,t,n){n.d(t,{f:function(){return l}});var o=n(4870),a=n(3396);function l(e){const t=(0,o.ref)();return(0,a.onActivated)((()=>{e.value&&e.value.setScrollTop(parseInt(t.value))})),onscroll=({scrollLeft:e,scrollTop:n})=>{t.value=n},onscroll}},9876:function(e,t,n){n.r(t),n.d(t,{default:function(){return be}});var o=n(7488),a=(n(9406),n(970)),l=(n(451),n(2951)),r=n(877),c=(n(9395),n(3396)),s=n(4870),i=n(3870),u=(n(1080),n(7139)),d=n(7026),m=n(2483),p=n(65);n(6982);const f=e=>((0,c.pushScopeId)("data-v-5ebbbab7"),e=e(),(0,c.popScopeId)(),e),g=["onClick"],v=["onClick"],h=f((()=>(0,c.createElementVNode)("span",null," / ",-1))),k=["onClick"];var C={__name:"menuSongList",props:{songMenuId:{type:Number,required:!0}},setup(e){const t=e,n=(0,m.tv)(),o=(0,p.useStore)(),a=((0,m.yj)(),(0,s.ref)(["undefined"]));o.dispatch("songMenu/getSongMenuList",t.songMenuId).then((e=>{a.value=e})),(0,c.onActivated)((()=>{}));const l=(0,c.computed)((()=>o.state.songMenu.songlist));(0,c.onDeactivated)((()=>{console.log("清空数据")}));const r=e=>{o.dispatch("playMusic/dispatchMusicInfo",e),o.commit("songMenu/CurrentMenuList",l.value)},f=e=>{console.log(e),n.push({path:"/singerDetailPage",query:{id:e}})},C=e=>{console.log(e),n.push({path:"/albumDetailPage",query:{ids:e}})},N=(0,c.computed)((()=>o.state.cancel));return(0,c.onUnmounted)((()=>{N.value(),o.state.songMenu.songlist=[]})),(e,t)=>{const n=i.GT;return(0,c.openBlock)(),(0,c.createElementBlock)("div",null,[(0,s.unref)(a).length?((0,c.openBlock)(),(0,c.createBlock)(d.Z,{key:1,songList:(0,s.unref)(l),onOnhandleClick:r},{author:(0,c.withCtx)((e=>[(0,c.createElementVNode)("span",{onClick:t=>f(e.row.author[0].id),class:"cursorHover"},(0,u.zw)(e.row.author[0].name),9,g),e.row.author[1]?((0,c.openBlock)(),(0,c.createElementBlock)("span",{key:0,onClick:t=>f(e.row.author[1].id),class:"cursorHover"},[h,(0,c.createTextVNode)(" "+(0,u.zw)(e.row.author[1].name),1)],8,v)):(0,c.createCommentVNode)("",!0)])),album:(0,c.withCtx)((e=>[(0,c.createElementVNode)("span",{onClick:t=>C(e.row.songsInfo.id),class:"cursorHover"},(0,u.zw)(e.row.album),9,k)])),_:1},8,["songList"])):((0,c.openBlock)(),(0,c.createBlock)(n,{key:0,description:"暂无音乐"}))])}}},N=n(89);const V=(0,N.Z)(C,[["__scopeId","data-v-5ebbbab7"]]);var w=V,y=n(1015),b=(n(8474),n(8179)),_=(n(6809),n(9242));const E=e=>((0,c.pushScopeId)("data-v-f8b756b8"),e=e(),(0,c.popScopeId)(),e),B={class:"detail"},x={class:"header",ref:"headerRef"},M={class:"img"},S={style:{height:"180px",width:"180px"}},T=["src"],I={class:"info"},z={class:"menu-name"},Z=E((()=>(0,c.createElementVNode)("span",{class:"info-menu"},"歌单",-1))),F={key:0,class:"createTime"},D=["src"],q={class:"three"},R=E((()=>(0,c.createElementVNode)("svg",{class:"icon play","aria-hidden":"true"},[(0,c.createElementVNode)("use",{"xlink:href":"#icon-playfill-copy-copy"})],-1))),P=E((()=>(0,c.createElementVNode)("span",null,"收藏",-1))),$={class:"four"},L={class:"five"},j=E((()=>(0,c.createElementVNode)("div",{class:"main"},null,-1)));function A(e,t,n,o,a,l){const r=b.mi,s=(0,c.resolveComponent)("FolderAdd"),i=y.gn,d=(0,c.resolveComponent)("Share"),m=(0,c.resolveComponent)("Download");return(0,c.openBlock)(),(0,c.createElementBlock)("div",B,[(0,c.withDirectives)((0,c.createElementVNode)("div",x,[(0,c.createElementVNode)("div",M,[(0,c.createElementVNode)("div",S,[(0,c.createElementVNode)("img",{src:`${e.songmenuinfo.coverImgUrl}?param=300y300`,alt:"image"},null,8,T)]),(0,c.createElementVNode)("div",I,[(0,c.createElementVNode)("div",z,[(0,c.renderSlot)(e.$slots,"title_name",{},(()=>[Z,(0,c.createElementVNode)("span",null,(0,u.zw)(e.songmenuinfo.name),1)]),!0)]),(0,c.renderSlot)(e.$slots,"alias",{},void 0,!0),e.songmenuinfo.createTime?((0,c.openBlock)(),(0,c.createElementBlock)("div",F,[(0,c.renderSlot)(e.$slots,"createTime",{},(()=>[(0,c.createElementVNode)("img",{src:e.songmenuinfo.creator.avatarUrl,alt:"",onClick:t[0]||(t[0]=t=>e.imgClick(e.songmenuinfo))},null,8,D),(0,c.createElementVNode)("a",{href:"javascript:void(0)",onClick:t[1]||(t[1]=t=>e.imgClick(e.songmenuinfo))},(0,u.zw)(e.songmenuinfo.creator.nickname),1),(0,c.createElementVNode)("span",null,(0,u.zw)(e.DateTimeFormat(e.songmenuinfo.createTime))+"创建",1)]),!0)])):(0,c.createCommentVNode)("",!0),(0,c.createElementVNode)("div",q,[(0,c.renderSlot)(e.$slots,"menu_buttom",{},(()=>[(0,c.createVNode)(r,{class:"three-items all_play",color:"red",type:"primary",round:"",onClick:e.playClick},{default:(0,c.withCtx)((()=>[R,(0,c.createTextVNode)(" 播放全部 ")])),_:1},8,["onClick"]),(0,c.createVNode)(r,{class:"three-items",color:"#F2F2F2",plain:"",onClick:e.handleSub},{default:(0,c.withCtx)((()=>[(0,c.createVNode)(i,{size:20},{default:(0,c.withCtx)((()=>[(0,c.createVNode)(s)])),_:1}),P,(0,c.createTextVNode)(" ("+(0,u.zw)(e.formatNumber(e.songmenuinfo.subscribedCount))+") ",1)])),_:1},8,["onClick"]),(0,c.createVNode)(r,{class:"three-items",color:"#F2F2F2",plain:"",onClick:e.handleShare},{default:(0,c.withCtx)((()=>[(0,c.createVNode)(i,null,{default:(0,c.withCtx)((()=>[(0,c.createVNode)(d)])),_:1}),(0,c.createTextVNode)("分享 ("+(0,u.zw)(e.formatNumber(e.songmenuinfo.shareCount))+")",1)])),_:1},8,["onClick"]),(0,c.createVNode)(r,{class:"three-items",color:"#F2F2F2",plain:"",onClick:e.handleDownload},{default:(0,c.withCtx)((()=>[(0,c.createVNode)(i,null,{default:(0,c.withCtx)((()=>[(0,c.createVNode)(m)])),_:1}),(0,c.createTextVNode)("下载全部")])),_:1},8,["onClick"])]),!0)]),(0,c.withDirectives)((0,c.createElementVNode)("div",$,[(0,c.createElementVNode)("span",null,[(0,c.createTextVNode)("标签: "),((0,c.openBlock)(!0),(0,c.createElementBlock)(c.Fragment,null,(0,c.renderList)(e.songmenuinfo.tags,(e=>((0,c.openBlock)(),(0,c.createElementBlock)("a",{key:e,href:"javascript:void(0)"},(0,u.zw)(e),1)))),128))])],512),[[_.F8,e.songmenuinfo.tags.length]]),(0,c.createElementVNode)("div",L,[(0,c.renderSlot)(e.$slots,"songsCount",{},(()=>[(0,c.createElementVNode)("span",null,"歌曲: "+(0,u.zw)(e.songmenuinfo.trackCount),1),(0,c.createElementVNode)("span",null,"播放: "+(0,u.zw)(e.formatNumber(e.songmenuinfo.playCount)),1)]),!0)])])])],512),[[_.F8,e.songmenuinfo]]),j])}var U=n(5867),H=n(1426),O=n(3741),G=(0,c.defineComponent)({name:"songmenudetail",components:{},props:{songmenuinfo:{type:Object,default:()=>{}}},setup(e){const t=(0,m.tv)(),n=(0,m.yj)(),o=(0,p.useStore)(),a=(0,s.ref)();console.log(e.songmenuinfo);const l=(0,c.computed)((()=>o.state.login.profile)),r=()=>{l.value||o.commit("login/changelogindialog",!0)},i=()=>{l.value||o.commit("login/changelogindialog",!0)},u=()=>{l.value||o.commit("login/changelogindialog",!0)},d=e=>{t.push({path:"/profilePage",query:{id:e.userId}})},f=()=>{(0,U.t)(n.query.id)};return{DateTimeFormat:H.U,formatNumber:O.u,headerRef:a,handleSub:r,handleShare:i,handleDownload:u,imgClick:d,playClick:f}}});const K=(0,N.Z)(G,[["render",A],["__scopeId","data-v-f8b756b8"]]);var Q=K,J=n(6501),W=n(9623);n(4566);const X={class:"subscribers"},Y=["src","onClick"],ee=["onClick"],te={class:"icon","aria-hidden":"true"},ne={key:0,"xlink:href":"#icon-xingbienan"},oe={key:1,"xlink:href":"#icon-xingbienv"},ae={class:"default"};var le={__name:"subscribers",props:{id:{type:Number,required:!0}},setup(e){const t=e,n=(0,p.useStore)(),o=(0,m.tv)(),a=(0,s.ref)(!1);n.dispatch("songMenu/getsubscriBers",t.id).then((e=>{e.subscribers.length||(a.value=!0)}));const l=(0,c.computed)((()=>n.state.songMenu.subscribers)),r=e=>{console.log(e),o.push({path:"/profilePage",query:{id:e.userId}})};return(e,t)=>{const n=W.Q0,o=i.GT;return(0,c.openBlock)(),(0,c.createElementBlock)(c.Fragment,null,[(0,c.createElementVNode)("div",X,[((0,c.openBlock)(!0),(0,c.createElementBlock)(c.Fragment,null,(0,c.renderList)((0,s.unref)(l),(e=>((0,c.openBlock)(),(0,c.createElementBlock)("div",{class:"items",key:e},[(0,c.createElementVNode)("img",{src:e.avatarUrl,alt:"img",onClick:t=>r(e)},null,8,Y),(0,c.createVNode)(n,{class:"box-item",effect:"light ",content:e.nickname,placement:"right-start"},{default:(0,c.withCtx)((()=>[(0,c.createElementVNode)("span",{onClick:t=>r(e)},(0,u.zw)(e.nickname),9,ee)])),_:2},1032,["content"]),((0,c.openBlock)(),(0,c.createElementBlock)("svg",te,[1===e.gender?((0,c.openBlock)(),(0,c.createElementBlock)("use",ne)):(0,c.createCommentVNode)("",!0),2===e.gender?((0,c.openBlock)(),(0,c.createElementBlock)("use",oe)):(0,c.createCommentVNode)("",!0)]))])))),128))]),(0,c.withDirectives)((0,c.createElementVNode)("div",ae,[(0,c.createVNode)(o,{description:"暂无收藏者"})],512),[[_.F8,(0,s.unref)(a)]])],64)}}};const re=(0,N.Z)(le,[["__scopeId","data-v-78fa69c7"]]);var ce=re,se=n(1565),ie=(n(7228),n(6097)),ue=(n(2760),n(9566)),de=n(4007),me=n(6644),pe=n(6862);const fe={key:0,class:"comment"},ge={class:"comment_title"};var ve={__name:"comment",props:{id:{type:Number,required:!0}},emits:["onClickPlgination"],async setup(e,{emit:t}){let n,o;const a=e,l=(0,m.yj)(),d=(0,s.ref)({limit:30,offset:1}),p=(0,s.ref)(!0),f=async e=>{const t=await me.Z.dispatch("songMenu/getComment",{id:a.id,limit:d.value.limit,offset:e*d.value.limit});t.length||(p.value=!1)};[n,o]=(0,c.withAsyncContext)((()=>f(0))),await n,o();const g=(0,c.computed)((()=>me.Z.state.songMenu.hotComments)),v=(0,c.computed)((()=>me.Z.state.songMenu.comment)),h=(0,c.computed)((()=>me.Z.state.songMenu.commentTotal)),k=(0,s.ref)(),C=(0,s.ref)(),N=(0,s.ref)(!1);(0,s.ref)();(0,c.watch)((()=>d.value.offset),(e=>{N.value=!0,t("onClickPlgination",C.value.commentRef.offsetTop),f(e-1)})),(0,c.watch)((()=>v.value),(e=>{e&&(N.value=!1)}));const V=(0,pe.K)(1e3),w=e=>{e.liked||V(parseInt(l.query.id),e.commentId,1,2,(e=>{e?((0,se.z8)({message:"点赞成功",grouping:!0,type:"success"}),f(d.value.offset-1)):(0,se.z8)({message:"点赞失败",grouping:!0,type:"error"})})),V(parseInt(l.query.id),e.commentId,0,2,(e=>{200!==!e.code?((0,se.z8)({message:"已取消点赞",grouping:!0,type:"success"}),f(d.value.offset-1)):(0,se.z8)({message:"操作出错",grouping:!0,type:"error"})}))};return(e,t)=>{const n=r.vk,o=ie.R,a=i.GT;return(0,s.unref)(p)?((0,c.openBlock)(),(0,c.createElementBlock)("div",fe,[1==(0,s.unref)(d).offset?((0,c.openBlock)(),(0,c.createBlock)(ue.Z,{key:0,comment:(0,s.unref)(g),class:"hot_comments",onOnClickStar:w},(0,c.createSlots)({_:2},[(0,s.unref)(g).length?{name:"comment-title",fn:(0,c.withCtx)((()=>[(0,c.createElementVNode)("span",ge,"精彩评论("+(0,u.zw)((0,s.unref)(g).length)+")",1)])),key:"0"}:void 0]),1032,["comment"])):(0,c.createCommentVNode)("",!0),(0,c.createElementVNode)("span",{class:"comment_title",ref_key:"agocomment",ref:k},"最新评论("+(0,u.zw)((0,s.unref)(h))+")",513),(0,c.createVNode)(n,{loading:(0,s.unref)(N),count:10},{template:(0,c.withCtx)((()=>[(0,c.createVNode)(de.Z)])),default:(0,c.withCtx)((()=>[(0,c.createVNode)(ue.Z,{comment:(0,s.unref)(v),ref_key:"newCommentRef",ref:C,onOnClickStar:w},null,8,["comment"])])),_:1},8,["loading"]),(0,c.createVNode)(o,{background:"",layout:"prev, pager, next",currentPage:(0,s.unref)(d).offset,"onUpdate:currentPage":t[0]||(t[0]=e=>(0,s.unref)(d).offset=e),"page-size":(0,s.unref)(d).limit,"onUpdate:page-size":t[1]||(t[1]=e=>(0,s.unref)(d).limit=e),total:(0,s.unref)(h),class:"pagination"},null,8,["currentPage","page-size","total"])])):((0,c.openBlock)(),(0,c.createBlock)(a,{key:1,description:"暂无评论"}))}}};const he=(0,N.Z)(ve,[["__scopeId","data-v-6daf2b13"]]);var ke=he,Ce=n(5399),Ne=n(1712),Ve=n(6237),we={__name:"songMenuDetailPage",setup(e){(0,s.ref)(!1);const t=(0,m.yj)(),n=(0,p.useStore)(),i=(0,s.ref)(),u=(0,s.ref)(!0),d=(0,s.ref)({}),f=(0,s.ref)(["歌曲列表","评论","收藏者"]);(0,c.watch)((()=>t.query.id),((e,o)=>{"songMenuDetailPage"==t.name&&(i.value=parseInt(e),n.dispatch("songMenu/getSongMenuDetail",e))}),{immediate:!0}),(0,c.watch)((()=>n.state.songMenu.playlist),(e=>{f.value[1]=`评论(${e.commentCount})`,d.value=e,0!=d.value.length&&(u.value=!1)})),(0,c.onMounted)((()=>{console.log("重新载入歌单")}));const g=(0,s.ref)(),v=(0,s.ref)(),h=e=>{console.log(e),g.value.setScrollTop(e+v.value.headerRef.clientHeight+50)},k=(0,s.ref)(0),C=e=>{console.log(e),k.value=e},N=(0,Ve.f)(g);return(e,t)=>{const n=r.vk,m=l.Z,p=a.Mr,V=o.mR;return(0,c.openBlock)(),(0,c.createElementBlock)(c.Fragment,null,[(0,c.createVNode)(p,{class:"song_menu_detail",ref_key:"songMenuRef",ref:g,onScroll:(0,s.unref)(N)},{default:(0,c.withCtx)((()=>[(0,c.createVNode)(n,{animated:"",loading:u.value},{template:(0,c.withCtx)((()=>[(0,c.createVNode)(Ne.Z)])),default:(0,c.withCtx)((()=>[(0,c.createVNode)(Q,{songmenuinfo:d.value,ref_key:"songMenuDetailRef",ref:v},null,8,["songmenuinfo"])])),_:1},8,["loading"]),(0,c.createVNode)(J.Z,{title:f.value,class:"tabs",onTabIndex:C},{0:(0,c.withCtx)((()=>[0===k.value?((0,c.openBlock)(),(0,c.createBlock)(c.Suspense,{key:0},{fallback:(0,c.withCtx)((()=>[(0,c.createVNode)(Ce.Z)])),default:(0,c.withCtx)((()=>[(0,c.createVNode)(w,{songMenuId:i.value},null,8,["songMenuId"])])),_:1})):(0,c.createCommentVNode)("",!0)])),1:(0,c.withCtx)((()=>[(0,c.createVNode)(m),1===k.value?((0,c.openBlock)(),(0,c.createBlock)(c.Suspense,{key:0},{fallback:(0,c.withCtx)((()=>[(0,c.createVNode)(Ce.Z)])),default:(0,c.withCtx)((()=>[(0,c.createVNode)(ke,{id:i.value,onOnClickPlgination:h},null,8,["id"])])),_:1})):(0,c.createCommentVNode)("",!0)])),2:(0,c.withCtx)((()=>[(0,c.createVNode)(ce,{id:i.value},null,8,["id"])])),_:1},8,["title"])])),_:1},8,["onScroll"]),(0,c.createVNode)(V,{right:50,bottom:110,"visibility-height":1e3,target:".el-scrollbar__wrap"})],64)}}};const ye=(0,N.Z)(we,[["__scopeId","data-v-29496678"]]);var be=ye},7488:function(e,t,n){n.d(t,{mR:function(){return y}});var o=n(3396),a=n(4870),l=n(9242),r=n(7139),c=n(6413),s=n(6367),i=n(1015),u=n(2748);const d={visibilityHeight:{type:Number,default:200},target:{type:String,default:""},right:{type:Number,default:40},bottom:{type:Number,default:40}},m={click:e=>e instanceof MouseEvent};var p=n(5989),f=n(6734);const g=e=>e**3,v=e=>e<.5?g(2*e)/2:1-g(2*(1-e))/2;var h=n(4620);const k=["onClick"],C={name:"ElBacktop"},N=(0,o.defineComponent)({...C,props:d,emits:m,setup(e,{emit:t}){const n=e,d="ElBacktop",m=(0,f.s)("backtop"),p=(0,a.shallowRef)(),g=(0,a.shallowRef)(),C=(0,a.ref)(!1),N=(0,o.computed)((()=>({right:`${n.right}px`,bottom:`${n.bottom}px`}))),V=()=>{if(!p.value)return;const e=Date.now(),t=p.value.scrollTop,n=()=>{if(!p.value)return;const o=(Date.now()-e)/500;o<1?(p.value.scrollTop=t*(1-v(o)),requestAnimationFrame(n)):p.value.scrollTop=0};requestAnimationFrame(n)},w=()=>{p.value&&(C.value=p.value.scrollTop>=n.visibilityHeight)},y=e=>{V(),t("click",e)},b=(0,c.vA)(w,300);return(0,s.ORN)(g,"scroll",b),(0,o.onMounted)((()=>{var e;g.value=document,p.value=document.documentElement,n.target&&(p.value=null!=(e=document.querySelector(n.target))?e:void 0,p.value||(0,h._)(d,`target is not existed: ${n.target}`),g.value=p.value)})),(e,t)=>((0,o.openBlock)(),(0,o.createBlock)(l.uT,{name:`${(0,a.unref)(m).namespace.value}-fade-in`},{default:(0,o.withCtx)((()=>[C.value?((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:0,style:(0,r.j5)((0,a.unref)(N)),class:(0,r.C_)((0,a.unref)(m).b()),onClick:(0,l.iM)(y,["stop"])},[(0,o.renderSlot)(e.$slots,"default",{},(()=>[(0,o.createVNode)((0,a.unref)(i.gn),{class:(0,r.C_)((0,a.unref)(m).e("icon"))},{default:(0,o.withCtx)((()=>[(0,o.createVNode)((0,a.unref)(u.CaretTop))])),_:1},8,["class"])]))],14,k)):(0,o.createCommentVNode)("v-if",!0)])),_:3},8,["name"]))}});var V=(0,p.Z)(N,[["__file","/home/runner/work/element-plus/element-plus/packages/components/backtop/src/backtop.vue"]]),w=n(9015);const y=(0,w.nz)(V)},9406:function(e,t,n){n(1758)}}]);
//# sourceMappingURL=songmenudetail.24c131cd.js.map